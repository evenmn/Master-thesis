\chapter{Selected Results} \label{chp:results}
\epigraph{Results! Why, man, I have gotten a lot of results. I know several thousand things that won't work.}{Thomas A. Edison, \supercite{noauthor_edisonian_nodate}}
\begin{figure}[H]
	\centering
	\includegraphics[scale=0.55]{../Images/art.eps}
	\caption{Radial one-body density profiles for two-dimensional quantum dots with $N=12$ electrons, popularly titled an artificial Magnesium atom. The four graphs correspond to four different oscillator frequencies, where the weakest oscillator gives the broadest density distribution.}
\end{figure}

We are finally ready to discuss the most exciting part of this thesis, namely the results. Since this work is associated with a degree in physics, the physical insights should be our focus and in this chapter we finally get the opportunity to discuss various physical interpretations of the results. Moreover, the various trial wave function ansätze used in variational Monte Carlo simulations (henceforth merely simulations) are discussed and compared. The Slater-Jastrow wave function is the \textit{de facto} standard ansatz used in variational Monte Carlo calculations of electronic structure problems. This ansatz, thoroughly discussed in chapter \ref{chp:methods}, is used as reference for our machine learning ansätze. Additionally, it is used for simulations of atomic systems, and will hereafter be abbreviated as the VMC ansatz. The most basic machine learning ansatz consists of a Slater determinant where the single-particle functions are determined by the marginal distributions of the visible nodes of a Gaussian-binary restricted Boltzmann machine. This is abbreviated as the RBM ansatz. When adding a simple Jastrow factor to this ansatz, we obtain the RBM+SJ ansatz. The RBM+PJ ansatz means that the Padé-Jastrow factor is added to the RBM ansatz. The respective Jastrow factors were discussed in section \ref{sec:jastrow}.

By using the implemented variational Monte Carlo framework described in chapter \ref{chp:WFE}, we can examine a large number of different systems. For quantum dot systems, the number of electrons, number of dimensions and oscillator frequency can all be varied. In total, we have looked at more than 150 different quantum dot systems using the four wave function ansätze mentioned above, which means that we have generated a large set of results. A selection of these results will be presented and discussed in this chapter, while a more extensive collection of results is presented in appendix \ref{chp:totalresults}. The results presented below have been selected since they describe physically interesting properties and allow for a comparison of the various ansätze. We will choose systems and configurations that can be compared with existing results. Our primary focus will be on ground state energy and electron density calculations, and we will stick to natural units as discussed in appendix \ref{app:units}. A brief recapitulation is that for quantum dots, the energy is given in units of Planck's reduced constant, $E'=E/\hbar$, and length is scaled as $x'=x/\sqrt{\hbar/m}$ with $m$ as the mass of an electron. This implies that the $d$-dimensional density, $\rho_d(\bs{r})$, is given in units of $(\hbar/m)^{-d/2}$. For atoms, we use Hartree atomic units, meaning that the length is given in units of the Bohr radius, $a_0$, the $d$-dimensional density is given in units of $a_0^{-d}$ and the energy is scaled as $E'=E/(\hbar^2/m_ea_0)$.

Before we move on to the physical results, we will take a quick look at some more technical results. More precisely, we will discuss the computational cost of the various ansätze and the energy convergence using various optimization tools. For validation purposes, we will present a few selected results on the case without repulsive interaction and compare it to analytical results. After that, we study the case with repulsive interaction on a much larger scale, where we first look at quantum dots and then on atoms. 

\begin{figure}
	\centering 
	\input{../pgf/cpu.tex}
	\caption{CPU-time per iteration as a function of the number of electrons, $N$, for two-dimensional (2D) and three-dimensional (3D) quantum dots. The number of Monte Carlo cycles per iteration is $M=2^{20}=1,048,576$. For more details see the text and appendix \ref{chp:totalresults}.}
	\label{fig:cpu_time}
\end{figure} 

\section{Computational cost}
Quantum many-body simulations are frequently ranked among the most computationally intensive fields. A reason for this is the large amount of information stored in the wave function. Albeit the VMC ansatz is known to have a high performance-cost ratio, it is still not cheap. In this section, we will find the average cost of the VMC ansatz and compare it to the cost of the machine learning ansätze described above. In figure \eqref{fig:cpu_time}, the CPU-time is plotted as a function of the number of electrons, $N$, for two-dimensional (left) and three-dimensional (right) quantum dots. To obtain accurate CPU-times, all the simulations were run on the Abel computer cluster with $M=2^{20}=1,048,576$ Monte Carlo cycles per iteration. The time presented is the average time over at least four independent runs with thousands of iterations each. For more details, see appendix \ref{chp:totalresults}, section \ref{sec:cputime}.

\begin{table}
	\caption{The scaling of the computational cost for two-dimensional (2D) and three-dimensional (3D) quantum dots as a function of the number of electrons, $N$. The numbers presented in the table are the optimal $b$-value found from fitting the power function $f(N)=0.5N^b$ to the cost graph. For abbreviations see the text.}
	\begin{tabularx}{\textwidth}{CCCCC} \hline\hline
		\label{tab:cputimefit}
		\makecell{\\ \phantom{=}} & RBM & RBM+SJ & RBM+PJ & VMC \\ \hline \\
		2D & 1.498 & 1.639 & 1.621 & 1.515 \\ 
		3D & 1.584 & 1.710 & 1.729 & 1.605 \\ \hline\hline
	\end{tabularx}
\end{table} 

Our immediate observation is that the ansätze are pairwise quite similar, with the RBM and VMC as the cheapest ones, and the RBM+SJ and RBM+PJ as the most expensive. This is not surprising, as RBM requires a neural network, VMC requires a Jastrow factor while RBM+SJ and RBM+PJ require both a neural network and a Jastrow factor. For two-dimensional dots, RBM is the cheapest among all the ansätze, but for larger systems ($N=42,56$), VMC is cheaper due to an explosion in CPU-time for the RBM ansatz. This explosion can be explained by our choice of the number of hidden nodes, $H$, which consequently is set to the number of electrons, i.e. $H=N$, which was found to give the lowest energy for small quantum dots\supercite{flugsrud_vilde_moe_solving_nodate}. Since the RBM ansatz has $N\cdot d\cdot (1+H)+H$ variational parameters with $d$ as the number of dimensions, the number of variational parameters for a two-dimensional dot with $N=90$ electrons is 16,470. On the other hand, the VMC ansatz is equipped with two variational parameters for all system sizes, which obviously makes the parameter update less costly. We also observe that the RBM+PJ ansatz is cheaper than the RBM+SJ ansatz for systems up to $N=42$, but after that, the RBM+SJ ansatz is slightly cheaper. This might be surprising, as the simple Jastrow factor contains $N^2$ variational parameters, but a possible explanation is that BLAS is optimized for large matrix-vector operations and is thus fully utilized first when the matrices get large. We observe the same behavior for the three-dimensional dots as for the two-dimensional dots, and the discussion above is representative for them as well.

The standard way of estimating the scaling of variational Monte Carlo simulations is to fit the power functions, $f(x)=ax^b$, to the cost graphs. As all the simulations were performed with the same hyper-parameters and with equal external factors. We fix the first parameter by setting $a=0.5$, as this was found to be a reasonable average value based on two-parameter fitting. In that manner, we can focus on optimizing $b$ only, which is the parameter that specifies the scaling, i.e.; we say that the method scales as $N^b$. In table \eqref{tab:cputimefit}, the optimal $b$ from linear regression is presented for our four ansätze for two- and three-dimensional quantum dots. We want to emphasize that we only did the regression for CPU-times up to $N=56$ in two-dimensional dots and $N=40$ in three-dimensional dots, partly because we only have data for all methods in this interval and partly because the CPU-time for the RBM explodes for large dots. We believe that this was the best way to do it in order to make the various methods comparable. 

The numbers in the table match our impression from figure \eqref{fig:cpu_time}, where RBM and VMC were found to be more expensive than RBM+SJ and RBM+PJ. For all the ansätze, the scaling was found to be between linear and quadratic as a function of the number of electrons, which is surprising as the update of the Slater matrix scales as $\sim N^2$. 

\section{Energy convergence}
We always want our simulations to converge fast and to be stable, which the optimization tool is responsible for. In figure \eqref{fig:convergenceoptimization}, we compare standard gradient descent (GD) to stochastic gradient descent (SGD) and ADAM for two- and three-dimensional quantum dots with $N=2$ interacting electrons. The optimization algorithms were detailed in section \ref{sec:optimizationalgorithms}. The gradient descent methods are plain, meaning it is without momentum and adaptive learning rate, while the ADAM optimizer has momentum and adaptivity by nature. The frequency $\omega=1.0$ is used for the two-dimensional case since the analytical energy, $E=3.0$, is available \supercite{taut_two_1993}. Similarly, we use the frequency $\omega=0.5$ for the three-dimensional case since the exact energy is $E=2.0$ \supercite{taut_two_1994}. 

\begin{figure}
	\centering 
	\subfloat{{\input{../pgf/convergence2D.tex}}}
	\caption{Convergence of the obtained ground state energy, $E$, for quantum dots with $N=2$ in two dimensions (2D) with frequency $\omega=1.0$ (left) and in three dimensions (3D) with frequency $\omega=0.5$ (right). The VMC ansatz was used, described in the text, and the optimization tools gradient descent (GD), stochastic gradient descent with 10 batches (SGD) and the ADAM optimizer are all compared. Semi-analytical energies (Exact) are taken from \citet{taut_two_1993} (2D) and \citet{taut_two_1994} (3D). The learning rate was set to $\eta=0.5$ and the number of Metropolis steps was $M=2^{24}=16,777,216$. All energies are given in units of $\hbar$ (natural units).}
	\label{fig:convergenceoptimization}
\end{figure} 

The first thing we observe is that all three optimization tools manage to converge to a value close to the exact energy (see spy window). The stochastic and non-stochastic gradient descent methods behave similarly, but we observe that the SGD goes below the exact energy before it stabilizes. The ADAM optimizer, fluctuates much more, which can be explained by the momentum, as discussed in section \ref{sec:momentum}. It is also important to remember that we use the VMC ansatz, which is equipped with two variational parameters only, and thus is easier to control. The ADAM optimizer is known to be good at minimizing functions with many variational parameters, so we will stick to it even though gradient descent seems like a clever choice seen from the figure. Another point is that the quantum dots have neat potentials without local minima. When we move on to more complex systems, ADAM generally works better according to the literature \supercite{kingma_adam:_2014}.

\begin{figure}
	\centering 
	\subfloat{{\input{../pgf/convergence42.tex}}}
	\caption{Convergence of the obtained ground state energy, $E$, for a two-dimensional quantum dot with $N=2$ and frequency $\omega=1.0$. The energy is obtained using various trial wave function ansätze detailed in the text. The learning rate was set to $\eta=0.5$ and the number of Metropolis steps used for each iteration was $M=2^{20}=1,048,576$. We use the ADAM algorithm for optimization. The semi-analytical energy, $E=3.0$, (Exact) is taken from \citet{taut_two_1993}, and all energies are given in units of $\hbar$ (natural units).}
	\label{fig:convergence42}
\end{figure} 

Further, we compare the energy convergence of the various trial wave function ansätze in figure \eqref{fig:convergence42}. VMC and RBM+PJ apparently give the lowest energy, followed by the RBM+SJ and RBM. Also the scale of the fluctuations (noise) seems to be in the same order, agreeing with the zero-variance property \supercite{assaraf_zero-variance_2003}. While VMC, RBM+SJ and RBM+PJ all immediately converge and stabilize, the RBM ansatz first converges to a value before it after more than 1000 iterations converges further to a new value. This illustrates that it can be hard to decide whether or not the simulation has converged when using machine learning ansätze, and an intelligent convergence criterion is needed in order to reveal if the simulation can be stopped or not. In practice, we often turn of the convergence check and let the simulation run the maximum number of iterations. We also observe that RBM is harder to train than the other methods, which is a result of the absence of a Jastrow factor.

\section{No repulsive interaction} \label{sec:norepulsive}
We start with the non-interacting case in order to validate the implemented code. For this case, we can calculate the energy and the electron density analytically for both quantum dots and atoms. It therefore serves as an excellent benchmark and validation for our code. The physical significance is though limited as non-interacting systems do not appear in the real world.

\subsection{Quantum dots}
The quantum dot system is the system we will keep most of the attention on, and for that reason, we will also validate the implemented quantum dot code thoroughly. As we use the harmonic oscillator potential to describe the external potential in the quantum dots, the system has well-known analytical results for the energy and other observables. The quantum dots have analytical expressions for the ground state energy given by equation \eqref{eq:HOenergies}. The number of electrons in closed-shell are given by the magic numbers in equation \eqref{eq:HOclosedshell}. In table \eqref{tab:quantumdotswointeraction}, we compare the energies obtained using the VMC and RBM ansätze to the analytical energy. The system we look at is a quantum dots with some selected numbers of electrons and the frequencies $\omega=0.5$ and $\omega=1.0$. From the results, it is clear that both the VMC and RBM ansätze reproduce the analytical expression when all the parameters are set to 1 and 0, respectively. This is expected as the exact wave functions are found when the parameters have these particular values. RBM+SJ and RBM+PJ were not included in the comparison as we expect them to give similar results to RBM and VMC.

\begin{table}
	\caption{The ground state energy of two-dimensional (2D) and three-dimensional (3D) quantum dots with $N$ non-interacting electrons and frequencies $\omega=0.5$, 1.0. Analytical values (Exact) are obtained by $E_n=\omega(n+1/2)$, and all values are given in units of $\hbar$ (natural units). The standard error is zero down to machine precision, and for abbreviations see the text.}
	\label{tab:quantumdotswointeraction}
	\begin{tabularx}{\textwidth}{r|rR{2cm}R{2cm}R{2cm}|R{2cm}R{2cm}R{2cm}} \hline\hline
		&& \multicolumn{3}{c}{$\omega=0.5$}&\multicolumn{3}{c}{$\omega=1.0$}\\ \hline
		\makecell{\\ \phantom{=}}& $N$ & \multicolumn{1}{c}{RBM} & \multicolumn{1}{c}{VMC} & \multicolumn{1}{c}{Exact} & \multicolumn{1}{c}{RBM} & \multicolumn{1}{c}{VMC} & \multicolumn{1}{c}{Exact} \\ \hline \\
		
		\parbox[t]{2mm}{\multirow{3}{*}{\rotatebox[origin=c]{90}{2D}}}
		&2 & 1.0 & 1.0 & 1 & 2.0 & 2.0 & 2\\
		%&6 & 5.0 & 5.0 & 5 & 10.0 & 10.0 & 10 \\
		&12 & 14.0 & 14.0 & 14 & 28.0 & 28.0 & 28\\
		%&20 & 30.0 & 30.0 & 30 & 60.0 & 60.0 & 60\\
		&30 & 55.0 & 55.0 & 55 & 110.0 & 110.0 & 110\\ \hline \\
		
		\parbox[t]{2mm}{\multirow{3}{*}{\rotatebox[origin=c]{90}{3D}}}
		&2 & 1.5 & 1.5 & 1.5 & 3.0 & 3.0 & 3 \\
		%&8 & 9.0 & 9.0 & 9 & 18.0 & 18.0 & 18 \\
		&20 & 30.0 & 30.0 & 30 & 60.0 & 60.0 & 60 \\
		%&40 & 75.0 & 75.0 & 75 & 150.0 & 150.0 & 150 \\
		&70 & 157.5 & 157.5 & 157.5 & 315.0 & 315.0 & 315 \\ \hline\hline
	\end{tabularx}
\end{table}

Electron density is another set of observable that we will devote particular attention to in this chapter. Comparing the obtained density to the analytical density gives a good indication of whether the implementation is correct or not. In figure \eqref{fig:OB_nointeraction}, the radial one-body density is plotted for two-dimensional (left) and three-dimensional (right) quantum dots with $N=2$ non-interacting electrons and frequency $\omega=1.0$. The VMC and RBM ansätze are used, and the density is compared to the exact density profile found from the definition of the one-body density in equation \ref{eq:onebody_density}. The results demonstrate that both ansätze are able to reproduce the exact density profile, which indicates that we have done the implementation correctly. However, the densities get noisy when they approach $r=0$, most notably in three dimensions, which can be explained by the way we calculate the radial one-body density. In section \ref{sec:electrondensityimplementation}, we saw that the innermost bins are also the smallest. This means that electrons are less likely to be observed there when the number of Monte Carlo cycles is finite. Apart from this noise, the density plot in two and three dimensions are identical, which can be explained mathematically by the fact that the electron density for non-interacting systems is trivially separable.

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat[2D]{\includegraphics[width=7cm]{../plots/int0/onebody/2D/2P/GD_MC2pow30_w1p0.png}}
	\subfloat[3D]{\includegraphics[width=7cm]{../plots/int0/onebody/3D/2P/GD_MC2pow30_w1p0.png}}
	\caption{Plots of the radial one-body density profile for quantum dots with $N=2$ non-interacting electrons and frequency $\omega=1.0$. Both two-dimensional (2D) and three-dimensional (3D) dots are simulated using the VMC and RBM ansätze, and they are compared to the analytical case $\rho(r)\propto\exp(-r^2)$ (Exact). For abbreviations and description of the natural units used, see the text.}
	\label{fig:OB_nointeraction}
\end{figure}

Furthermore, we examine the spatial one-body density and radial two-body density. For the same quantum dot system as above, the density profiles are compared to analytical results in figure \eqref{fig:ED_nointeraction}. For the one-body density plots, we observe that both the RBM and VMC ansätze provide density profiles similar the exact profile. Also the two-body densities match the analytical density profile for both ansätze, but we observe a suspicious cross on the obtained two-body density profiles. This cross occurs since we in practice calculate the density for positive $r_i$ and $r_j$. We then get the density profile presented in the first quadrant of the plots, and simply rotate the same density around origin ($r_i=r_j=0$) to get intuitive and illustrative plots. This also explains the negative values of $r_i$ and $r_j$, which otherwise would not make sense. 

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{2.cm}{\rotatebox[origin=t]{90}{one-body}}}\hspace{0.1cm}
	\subfloat{\includegraphics[width=5.1cm]{../plots/int0/onebody2/2D/2P/1.000000w/RBM_ADAM_MC268435456.png}}
	\subfloat{\includegraphics[width=5.1cm]{../plots/int0/onebody2/2D/2P/1.000000w/VMC_GD_MC2pow30_blue_small.png}}
	\subfloat{\includegraphics[width=5.1cm]{../plots/int0/onebody2/2D/2P/1.000000w/Exact.png}}
	
	\subfloat{\raisebox{2.cm}{\rotatebox[origin=t]{90}{two-body}}}\hspace{0.1cm}
	\subfloat[RBM]{{\includegraphics[width=5.1cm]{../plots/int0/twobody/RBM/2D/2P/1.000000w/RBM_GD_MC2pow30.png}}}
	\subfloat[VMC]{{\includegraphics[width=5.1cm]{../plots/int0/twobody/VMC/2D/2P/1.000000w/VMC_GD_MC2pow30.png}}}
	\subfloat[Exact]{{\includegraphics[width=5.1cm]{../plots/int0/twobody/VMC/2D/2P/1.000000w/exact.png}}}
	
	\caption{Plots of the electron density profile, $\rho$, of a two-dimensional quantum dot with $N=2$ non-interacting electrons and frequency $\omega=1.0$. The upper plots are the (spatial) one-body density distribution (one-body), where the surface plot and the contour plot on the $xy$-plane illustrate the density, and the graph on the $yz$-plane represents the cross-section through $x=0$. The lower plots are the radial two-body density distributions (two-body). Besides, we compare the results to the analytical densities (Exact), given by $\rho(x,y)\propto\exp(-x^2-y^2)$ and $\rho(r_i,r_j)\propto\text{exp}(-r_i^2-r_j^2)$, respectively. For  abbreviations and description of the natural units used, see the text.}
	\label{fig:ED_nointeraction}
\end{figure}

As discussed in section \ref{sec:electrondensity}, the electron density should be normalized such that the integral over the density function, $\rho$, corresponds to the number of electrons. \iffalse For the one-body density, this corresponds to $\int dr\rho(r)=N$ for the radial density profile and $\int dxdy\rho(x,y)=N$ for the spatial density distribution and for the two-body radial density profile the normalization condition is $\int dr_idr_j\rho(r_i,r_j)=N$.\fi However, there is no standard way of normalizing these densities when they are calculated using bins, as the normalization constant depends of the number of bins. This is not very important either; we are only interested in the relative densities and the shapes of the density plots. We have been consequent when normalizing the density plots, such that the various density magnitudes can be compared to each other.

\subsection{Atoms}
To further verify the implementation, we address atomic systems with non-interacting electrons. For these systems, the variational Monte Carlo simulations are based on a trial wave function ansatz consisting of a single Slater determinant with the hydrogen-like orbitals as the single-particle functions. In table \eqref{tab:atomswointeraction}, the ground state energy of some selected atoms are listed with the exact energies, given by the Bohr formula presented in equation \eqref{eq:bohrformula}. Besides, we add calculations of the hydrogen ground state energy as another simple validation of the code. It is apparent that the obtained energies are in line with the exact energies, indicating that the code simulates atomic systems correctly.

\begin{table}
	\caption{Ground state energy of neutral atoms with atomic number $Z$ and non-interacting electrons. A single Slater determinant with hydrogen-like orbitals was used as the trial wave function ansatz. The analytical energy (Exact) is obtained by the Bohr formula, $E_n=Z^2/2n^2$. The variance is zero to machine-precision for all listed results. For abbreviations and description of the Hartree atomic units used, see the text.}
	\label{tab:atomswointeraction}
	\begin{tabularx}{\textwidth}{R{3.5cm}lrrR{2.5cm}R{2.5cm}} \hline\hline
		& Atom & $Z$ & \makecell{\\ \phantom{=}} & VMC & Exact \\ \hline \\
		
		& H & 1 && -0.5 & -0.5 \\
		& He & 2 && -4.0 & -4 \\
		& Be & 4 && -20.0 & -20 \\
		& Ne & 10 && -200.0 & -200 \\ \hline\hline
	\end{tabularx}
\end{table}

For completeness, we present the radial one-body density of the helium atom in figure \eqref{fig:helium_nointeraction}. The density is multiplied by $r^2$ as this allows us to clarify the peaks in the one-body density. We see that the produced density curve is more or less identical to the exact density curve, found from the definition in section \ref{eq:onebody_density}.

\begin{figure}[H]
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\includegraphics[width=9cm]{../plots/int0/onebody/helium.png}}
	\caption{Plot of the radial one-body density profile for the non-interacting helium atom. A single Slater determinant with hydrogen-like orbitals was used as the trial wave function ansatz. The analytical density (Exact) was obtained by the formula $\rho(r)\propto\exp(-2r)$, and the densities were multiplied with the radius squared. For abbreviations and description of the Hartree atomic units used, see the text.}
	\label{fig:helium_nointeraction}
\end{figure}

\cleardoublepage
\section{Quantum dots} \label{sec:quantumdotresults}
We now move on to the more interesting case with repulsive interaction between the electrons. Analytical results are in general unavailable for this case, apart from a few semi-analytical energies and wave functions for the two- and three-dimensional quantum dots. We will for this system calculate the ground state energy, the one-body density, and the two-body density. 

The simulations depend on an array of hyper-parameters, which need to be reasonable in order to achieve acceptable results. Firstly, the simulations are very sensitive to the learning rate. On one hand, it has to be large enough for the simulation to converge in an adequate number of steps. On the other hand, it needs to be small to avoid the gradients to explode as discussed in chapter \ref{chp:machinelearning}. Appropriate learning rates were found to be in the range $\eta\in(10^{-5}, 10^{0})$, where large systems and/or systems with low frequency required the lowest learning rates. Also, the step length needs to be set cleverly, as we want to sample over the space where the electrons physically can be located in a reasonable number of cycles. For a narrow oscillator potential (high frequency), the step length is typically smaller than for a wide oscillator (low frequency). The acceptance ratio is directly dependent on the step length, where we want a high acceptance ratio to keep the computational cost low. However, we experienced that a too high acceptance ratio is neither favorable, as it may makes the simulation divergence. Keeping an acceptance ratio at around 0.995 was found to be optimal, with a step length in the range $\Delta x\in(10^{-2},10^0)$. The initial electron and parameter configurations are crucial in order to make the simulations converge rapidly. Furthermore, the statistical error depends on the number of Monte Carlo cycles, where a large number of cycles is preferred as discussed in section \ref{sec:vmc}. 

We have applied an adaptive number of cycles, which means that the number of Monte Carlo cycles per iteration is increased for the last iterations. Firstly, this makes the final energy more accurate due to more statistics. Secondly, we obtain less noisy convergence and density plots with this technique. All results below are produced using $M=2^{20}=1,048,576$ number of cycles per iteration until the energy has converged. Then, we run 10 more iterations with the number of cycles increased to $M=2^{24}=16,777,216$ and for the very last iteration we run $M=2^{28}=268,435,456$ or $M=2^{30}=1,073,741,824$ cycles.

Initially, we look at two-dimensional quantum dots with up to $N=56$ electrons and three-dimensional quantum dots with up to $N=40$ electrons. The frequencies span from  $\omega=0.1$ to $\omega=1.0$. For those systems, we will compute the ground state energy, the one-body density, and the two-body density. After that, we move on to some special cases where the dots have low frequency ($\omega=0.01$) and large dots ($N>56$) to test how far we can go. We also have a thorough discussion of how the energy is distributed between kinetic and potential energy, and compare the kinetic-potential energy ratio to the virial theorem.

\afterpage{
	\begin{landscape}
		\begin{table}
			\captionsetup{width=0.9\hsize}
			\caption{The ground state energy of two-dimensional quantum dots with $N$ electrons and frequency $\omega$. The HF results are taken from \citet{mariadason_quantum_2018}, the DMC results are taken from \citet{hogberget_quantum_2013} and semi-analytical results (Exact) are taken from \citet{taut_two_1994}. The energy is given in units of $\hbar$ (natural units), and the numbers in parenthesis are the statistical uncertainties in the last digit. Empty spots imply that the result is not available. For abbreviations see the text.}
			\begin{tabularx}{\hsize}{llR{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}} \hline\hline
				\label{tab:quantumdotswinteraction2D1}
				\makecell{\\ $N$ \\ \phantom{=}} & $\omega$ & \multicolumn{1}{c}{RBM} & \multicolumn{1}{c}{RBM+SJ} & \multicolumn{1}{c}{RBM+PJ} & \multicolumn{1}{c}{\makecell{HF \\ (Ref.\cite{mariadason_quantum_2018})}} & \multicolumn{1}{c}{VMC} & \multicolumn{1}{c}{\makecell{DMC \\ (Ref.\cite{hogberget_quantum_2013})}} & \multicolumn{1}{c}{\makecell{Exact \\ (Ref.\cite{taut_two_1994})}} \\ \hline \\
				2 & 0.1 & 0.4728(1) & 0.44856(1) & 0.440975(8) & 0.525635 & 0.44129(1) & 0.44079(1) \\ 
				& 1/6 & 0.7036(1) & 0.67684(7) & 0.66715(6) & 0.768675 & 0.66710(1) & & 2/3 \\
				& 0.28 & 1.07050(4) & 1.03470(7) & 1.021668(7) & 1.14171 & 1.02192(1) & 1.02164(1) \\
				& 0.5 & 1.72293(7) & 1.67739(9) & 1.659637(6) & 1.79974 & 1.65974(1) & 1.65977(1)  \\
				& 1.0 & 3.0803(2) & 3.02108(5) & 2.999587(5) & 3.16190 & 2.99936(1) & 3.00000(1) & 3.0 \\ 
				\hline \\
				
				6 & 0.1 & 3.697(1) & 3.63825(9) & 3.5700(2) & 3.85238 & 3.5695(1) & 3.55385(5) \\ 
				& 0.28 & 7.9273(9) & 7.7313(2) & 7.6203(2) & 8.01957 & 7.6219(1) & 7.60019(6) \\
				& 0.5 & 12.241(1) & 11.9659(5) & 11.8074(2) & 12.2713 & 11.8104(2) & 11.78484(6) \\
				& 1.0 & 20.716(1) & 20.3393(8) & 20.1832(2) & 20.7192 & 20.1918(2) & 20.15932(8) \\ \hline \\
				
				12 & 0.1 & 12.679(1) & 12.5964(7) & 12.3416(4) & 12.9247 & 12.29962(9) & 12.26984(8) \\ 
				& 0.28 & 26.389(2) & 26.051(1) & 25.7331(5) & 26.5500 & 25.7049(4) & 25.63577(9) \\
				& 0.5 & 40.440(3) & 39.6340(7) & 39.2743(6) & 40.2161 & 39.2421(5) & 39.1596(1) \\
				& 1.0 & 67.632(3) & 66.1898(8) & 65.7911(7) & 66.9113 & 65.7026(4) & 65.7001(1) \\ \hline
			\end{tabularx}
		\end{table}
		
		\begin{table}
			\label{tab:quantumdotswinteraction2D2}
			\begin{tabularx}{\hsize}{llR{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}} \\
				20 & 0.1 & 30.824(2) & 30.567(3) & 30.1553(9) & 31.1902 & 30.0403(2) & 29.9779(1) \\ 
				& 0.28 & 63.788(4) & 62.786(3) & 62.148(1) & 63.5390 & 62.0755(7) & 61.9268(1) \\
				& 0.5 & 96.410(1) & 94.920(4) & 94.104(1) & 95.7328 & 94.0433(9) & 93.8752(1) \\
				& 1.0 & 159.428(3) & 156.816(4) & 156.104(1) & 158.004 & 155.8900(4) & 155.8822(1) & \phantom{=} \\ 
				\hline \\
				
				30 & 0.1 & 61.829(5) & 61.198(2) & 60.774(2) & & 60.585(1) & 60.4205(2) \\ 
				& 0.28 & 126.958(6) & 125.413(2) & 124.437(2) & & 124.195(2) & 123.9683(2) \\
				& 0.5 & 191.495(7) & 188.995(5) & 187.488(2) & & 187.325(3) & 187.0426(2) \\
				& 1.0 & 315.364(8) & 309.997(6) & 308.989(2) & & 308.576(1) & 308.5627(2) \\ \hline \\
				
				42 & 0.1 & 109.892(6) & 109.48(2) & 108.183(1) & &  107.928(2) & 107.6389(2) \\ 
				& 0.28 & 224.462(8) & 224.184(9) & 222.200(5) & & 220.224(2) & 219.8426(2) \\
				& 0.5 & 337.523(8) & 333.582(9) & 331.410(3) & & 331.276(3) & 330.6306(2) \\
				& 1.0 & 553.40(1) & 545.817(9) & 543.746(3) & & 542.977(2) & 542.9428(8) \\ \hline \\
				
				56 & 0.1 & 179.789(6) & 179.59(1) & 178.501(5) & & 176.774(3) & 175.9553(7) \\ 
				& 0.28 & 364.85(1) & 364.165(9) & 359.83(2) & & 359.63(1) & 358.145(2) \\
				& 0.5 & 547.46(1) & 545.74(1) & 538.810(7) & & 538.686(9) & 537.353(2) \\
				& 1.0 & 894.12(2) & 882.93(1) & 881.010(5) & & 879.514(3) & 879.3986(6) \\ \hline\hline
			\end{tabularx}
		\end{table}
		
		\begin{table}
			\captionsetup{width=0.9\hsize}
			\caption{The ground state energy of three-dimensional quantum dots with $N$ electrons and frequency $\omega$.  The HF results are taken from \citet{mariadason_quantum_2018}, the DMC results are taken from \citet{hogberget_quantum_2013} and semi-analytical results (Exact) are taken from \citet{taut_two_1993}. The energy is given in units of $\hbar$ (natural units), and the numbers in parenthesis are the statistical uncertainties in the last digit. Empty spots imply that the result is not available. For abbreviations see the text.} 
			\begin{tabularx}{\hsize}{llR{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}R{2.65cm}} \hline\hline
				\label{tab:quantumdotswinteraction3D1}
				\makecell{\\ $N$ \\ \phantom{=}} & $\omega$ & \multicolumn{1}{c}{RBM} & \multicolumn{1}{c}{RBM+SJ} & \multicolumn{1}{c}{RBM+PJ} & \multicolumn{1}{c}{\makecell{HF \\ (Ref.\cite{mariadason_quantum_2018})}} & \multicolumn{1}{c}{VMC} & \multicolumn{1}{c}{\makecell{DMC \\ (Ref.\cite{hogberget_quantum_2013})}} & \multicolumn{1}{c}{\makecell{Exact \\ (Ref.\cite{taut_two_1993})}} \\ \hline \\
				2 & 0.1 & 0.5177(1) & 0.50214(3) & 0.500080(6) & 0.529065 & 0.500083(7) & 0.499997(3) & 0.5 \\
				& 0.28 & 1.2261(1) & 1.20475(4) & 1.201710(6) & 1.23722 & 1.201752(6) & 1.201725(2) \\
				& 0.5 & 2.0269(1) & 2.00371(4) & 1.999912(5) & 2.03851 & 1.999977(5) & 2.000000(2) & 2.0 \\
				& 1.0 & 3.7574(1) & 3.73543(4) & 3.729827(5) & 3.77157 & 3.730030(5) & 3.730123(3) \\ 
				\hline \\
				
				8 & 0.1 & 5.8910(6) & 5.7498(4) & 5.718(4) & 5.86255 & 5.7126(1) & 5.7028(1) \\ 
				& 0.28 & 12.650(1) & 12.2492(4) & 12.2056(2) & 12.3987 & 12.2050(2) & 12.1927(1) \\
				& 0.5 & 19.487(2) & 19.0241(4) & 18.9747(2) & 19.1916 & 18.9759(1) & 18.9611(1) \\
				& 1.0 & 33.302(1) & 32.7159(6) & 32.6820(2) & 32.9246 & 32.6863(2) & 32.6680(1) \\ 
				\hline \\
				
				20 & 0.1 & 27.813(2) & 27.470(1) & 27.3382(8) & & 27.3144(5) & 27.2717(2) \\ 
				& 0.28 & 57.700(4) & 56.600(1) & 56.4477(6) & & 56.4297(5) & 56.3868(2) \\
				& 0.5 & 87.840(4) & 85.893(1) & 85.7153(6) & & 85.7161(5) & 85.6555(2) \\
				& 1.0 & 146.292(4) & 143.209(2) & 142.9409(6) & & 142.9560(7) & 142.8875(2) \\ \hline \\
				
				40 & 0.1 & 89.45(8) & 89.618(4) & 88.596(4) & & 88.182(1) \\ 
				& 0.28 & 182.714(6) & 181.877(4) & 179.630(1) & & 179.567(1) \\
				& 0.5 & 275.262(7) & 271.030(4) & 269.782(2) & & 269.746(1) \\
				& 1.0 & 452.732(8) & 442.874(4) & 442.630(1) & & 442.602(2) \\ \hline\hline
			\end{tabularx}
		\end{table}
	\end{landscape}
}

\subsection{Ground state energy} \label{sec:groundstateenergy}
The ground state energy is a natural starting point as the simulations are based on energy minimization. Moreover, the energy can easily be compared to benchmarks. By exploiting the symmetry of quantum dots with $n=2$ electrons, \citeauthor{taut_two_1993} was able to obtain semi-analytical energies for quantum dots of certain frequencies $\omega$. For two-dimensional dots, he found the energy to be $E=3$ for the frequency $\omega=1$ and $E=2/3$ with $\omega=1/6$ as the frequency \supercite{taut_two_1993}. Additionally, his studies of three-dimensional dots revealed the energy $E=2$ for the frequency $\omega=1/2$ and $E=1/2$ with $\omega=1/10$ as the frequency \supercite{taut_two_1994}. For other references we need to rely on earlier research, usually other simulations. Since diffusion Monte Carlo (DMC) simulations are known to give very accurate results, we will mainly compare our results to the DMC computations by \citet{hogberget_quantum_2013}. These results exist for quantum dots with up to $N=56$ electrons in two dimensions and with up to $N=20$ electrons in three dimensions. Another important reference is the Hartree-Fock (HF) limit, as the HF method approximates the electron-electron correlations by a mean-field. This is a particular interesting reference for simulations with the RBM ansatz, as both the methods approximate the many-body wave function with a single Slater determinant only. Practically, RBM should give a lower energy than the HF limit as the latter is known to be computationally cheap. We use the HF computations from \citet{mariadason_quantum_2018} for two-dimensional quantum dots with up to $N=20$ electrons and three-dimensional quantum dots with up to $N=8$ electrons. For the two-dimensional quantum dot with frequency $\omega=1/6$, we obtained the HF energy using the code developed \citeauthor{mariadason_quantum_2018}\supercite{mariadason_hartreefock_2018}.

Ground state energy computations of two- and three dimensional quantum dots are found in tables \eqref{tab:quantumdotswinteraction2D1} and \eqref{tab:quantumdotswinteraction3D1}, respectively. They are computed using the RBM, RBM+SJ, RBM+PJ and VMC ansätze, and the HF limit and DMC are present for reference purposes. The analytical values are found in the last column. We observe that the ansatz that requires least physical intuition is used, RBM, is the one that gives the highest energies among the ansätze. This is expected as no Jastrow factor is added to account for the correlations. 

For small quantum dots ($N<8$), the RBM ansatz provides a lower energy than the HF limit, and for low frequencies ($\omega<0.5$) the obtained energy is generally also lower. This indicates that simulations with the RBM ansatz is better at modeling the correlations compared to the HF method, which is important in strongly interacting systems. Nevertheless, for higher frequencies and larger dots, the HF limit is lower than the energy obtained using the RBM ansatz. It is apparent that the mean-field approximation works better than RBM when the correlations get less important. When we add more intuition to the trial wave function ansatz in the form of a simple Jastrow factor (RBM+SJ), the energy drops significantly, especially for high frequencies. It is, therefore, lower than the HF limit for all simulations, and surprisingly close to the reference considering the simple form of the Jastrow factor. The statistical errors of RBM+SJ is in general smaller than for RBM, which is a good indication that the method provides a better ground state estimate as the actual ground state obeys a zero-variance property \supercite{assaraf_zero-variance_2003}. 

Furthermore, we add a more complex Jastrow factor in the form of a Padé-Jastrow factor to the RBM ansatz, and we observe that the energy drops further. The RBM+PJ ansatz provides energies entirely on par with VMC, in many cases even lower. Notably, RBM+PJ provides the lowest energies among our implemented methods for dots with $N=2$ electrons, and the statistical errors are also the lowest. This hints that RBM+PJ can obtain a better ground state estimate than VMC for the smallest dots. However, for large dots, RBM+PJ provides slightly higher energies than VMC. We speculate that this might be due to the large number of variational parameters residing the trial wave function, resulting in a too complex model for the problem. If we recall that the number of hidden units is set to the number of electrons, the number of variational parameters increases rapidly as the number of electrons increases. 

A further novel finding is that all the methods and ansätze provide energies closer to the reference energy in three dimensions compared to two dimensions. For three-dimensional dots, we have a phase space of higher dimensionality than for two-dimensional dots, allowing a larger set of particle configurations. Obtaining an adequate estimate of the ground state energy is therefore more accessible in three dimensions compared to two dimensions.

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=2$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/2P/1.000000w/RBM_ADAM_MC2pow28_smooth_blue.png}}}\hspace{-0.0cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/2P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue.png}}}\\
	
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=6$}}}\hspace{0.05cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/6P/1.000000w/RBM_ADAM_MC2pow28_smooth_blue.png}}}\hspace{-0.0cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/6P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue.png}}}\\
	
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=12$}}}\hspace{0.1cm}
	\subfloat[RBM]{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/12P/1.000000w/RBM_ADAM_MC2pow28_smooth_blue.png}}}\hspace{-0.0cm}
	\subfloat[VMC]{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/12P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue.png}}}
	
	\caption{Plots of the one-body density profiles, $\rho(x,y)$, for two-dimensional quantum dots with frequency $\omega=1.0$ and $N=2$, 6 and 12 electrons seen from the top. The surface plot and the contour plot on the $xy$-plane illustrate the density, and the graph on the $yz$-plane represents the cross-section through $x=0$. They were obtained using RBM (left column) and VMC (right column), with the ADAM optimizer and $M=2^{30}=1,073,741,824$ Monte Carlo cycles after convergence. The plots are noise-reduced using a Savitzky-Golay filter. For abbreviations and description of the natural units used, see the text.}
	\label{fig:OB_interaction_1p0w1}
\end{figure}
\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=20$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/20P/1.000000w/RBM_ADAM_MC2pow28_smooth_blue.png}}}\hspace{-0.0cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/20P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue.png}}}\\
	
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=30$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/30P/1.000000w/RBM_ADAM_MC2pow28_smooth_blue.png}}}\hspace{-0.0cm}
	\subfloat{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/30P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue.png}}}\\
	
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=42$}}}\hspace{0.1cm}
	\subfloat[RBM]{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/42P/1.000000w/RBM_ADAM_MC2pow28_smooth_blue.png}}}\hspace{-0.0cm}
	\subfloat[VMC]{{\includegraphics[width=7.8cm]{../plots/int1/onebody2/2D/42P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue.png}}}
	
	\caption{Plots of the one-body density profiles, $\rho(x,y)$, for two-dimensional quantum dots with frequency $\omega=1.0$ and $N=20$, 30 and 42 electrons seen from the top. The surface plot and the contour plot on the $xy$-plane illustrate the density, and the graph on the $yz$-plane represents the cross-section through $x=0$. They were obtained using RBM (left column) and VMC (right column), with the ADAM optimizer and $M=2^{30}=1,073,741,824$ Monte Carlo cycles after convergence. The plots are noise-reduced using a Savitzky-Golay filter. For abbreviations and description of the natural units used, see the text.}
	\label{fig:OB_interaction_1p0w2}
\end{figure}

\subsection{One-body density} \label{sec:onebodyresults}
Another quantity of particular interest is the one-body density. For all the systems presented in tables \eqref{tab:quantumdotswinteraction2D1} and \eqref{tab:quantumdotswinteraction3D1} we have also calculated the one-body density. However, since the total collection of one-body density plots is comprehensive, it is dumped to appendix \ref{chp:totalresults}. Instead, we present the (arguably) most interesting plots of the one-body density here. 

We have computed the one-body density in two different ways: by dividing the space into plural annuluses and obtaining the radial density profile, as discussed in section \ref{sec:electrondensityimplementation}, and by dividing the space into a grid of equally sized bins and obtaining the density profile throughout the space. The former is computationally beneficial as the density typically is stored in $n$ bins compared to $n^2$ bins for the second method, but the latter is clearly able to store more information. The second method is thereby able to give more informative plots, but when we want to compare the various methods, a radial density profile is more convenient. In other words, there are pros and cons associated with both methods, and we will, therefore, present both to give an as comprehensive description of the results as possible. 

Initially, we will present the spatial density profiles for two-dimensional quantum dots of frequency $\omega=1.0$. In figure \eqref{fig:OB_interaction_1p0w1} and \eqref{fig:OB_interaction_1p0w2}, the evolution of the one-body density for dots of sizes $N=2$, 6, 12, 20, 30 and 42 are presented, produced with RBM and VMC. To maximize the amount of information in the plots, we have included a graph presenting the cross-section through $x=0$ on the $yz$-plane and a contour plot of the density on the $xy$-plane, in addition to a 3D surface plot of the density. What we observe is that the density profile is smooth, with more peaks as the number of electrons increases, representing high densities. For an odd number of shells ($N=2$, 12 and 30) the density has its maximum at the center of the dot, resulting in equal shapes where for example the shape of $N=12$ is seen as the top of $N=30$. On the other hand, for an even number of shells ($N=6$, 20 and 42) the highest density is found at a ridge that encircles the center, and also here the shape of for example $N=20$ is seen as the top of $N=42$. It is apparent that those are the configurations that minimize the energy, with a structure following directly from the Pauli principle, as the electrons are forced to distribute over multiple shells. Even when we remove the interaction between the electrons, we get the same characteristic wave shape, though narrower. The RBM provides sharper and more distinct peaks than the VMC, but at least the extrema seem to be located at the same radii. These differences are caused by the ways the methods model the correlations, where the VMC employs the Padé-Jastrow factor, and the RBM needs to find the best way to account for the correlations itself. To connect the observations to something everyone is familiar with, we can compare the density plots to water ripples if one sees it from the smallest to the largest dot. \citet{hogberget_quantum_2013} discusses this in his master thesis, and his one-body densities are consistent with what we have obtained. However, for $N=42$ the RBM provides a density profile that has ripples in both radial and angular direction, indicating that the simulation has not fully converged to the minimum. This might be an effect of the large number of variational parameters. One-body density plots for the same systems using an RBM+SJ and RBM+PJ were generated, but in order to limit us to a few plots we decided to keep the extremes here, and placed the others in appendix \ref{chp:totalresults}.

In figure \eqref{fig:OB_interaction_23D}, we stick to frequency $\omega=1.0$ for small two- and three-dimensional quantum dots and compare the results obtained by VMC, RBM, RBM+SJ, and RBM+PJ. We investigate dots with $N=2$, 6 and 12 in two dimensions and $N=2$, 8 and 20 in three dimensions. This corresponds to one shell ($S=1$), two shells ($S=2$) and three shells ($S=3$), respectively. For all the numbers of shells, we immediately see that the density plots are identical for two- and three-dimensional dots. The same phenomenon was observed for quantum dots with non-interacting electrons in figure \eqref{fig:OB_nointeraction}, which can easily be explained as the wave function is trivially separable. However, this is not the situation when we look at the interacting case, and it was therefore not obvious to us that the same phenomenon would occur here. Physically, this means that the electrons configure in the same way in three dimensions as in two dimensions, where the average distance from a "shell" to the center of the dot is dimensionless. Besides the physics, we are also interested in analyzing the performance of the various methods. We observe that all the methods give quite similar radial density profiles, but RBM stands out. Apparently, the RBM tends to exaggerate the peaks discussed above and gives an even more wavy density plot, as 
\begin{figure}[H]
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{$S=1$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue_small.png}}}\hspace{-0.0cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody/2D/2P/1.000000w/ADAM_MC1048576.png}}}\hspace{-0.5cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody/3D/2P/1.000000w/ADAM_MC1048576.png}}}\\ [-0.2cm]
	
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{$S=2$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue_small.png}}}\hspace{-0.0cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody/2D/6P/1.000000w/ADAM_MC1048576.png}}}\hspace{-0.5cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody/3D/8P/1.000000w/ADAM_MC1048576.png}}}\\ [-0.2cm]
	
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{$S=3$}}}\hspace{0.1cm}
	\subfloat[VMC, 2D]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/12P/1.000000w/VMC_ADAM_MC2pow28_smooth_blue_small.png}}}\hspace{-0.0cm}
	\subfloat[2D]{{\includegraphics[width=5.1cm]{../plots/int1/onebody/2D/12P/1.000000w/ADAM_MC1048576.png}}}\hspace{-0.5cm}
	\subfloat[3D]{{\includegraphics[width=5.1cm]{../plots/int1/onebody/3D/20P/1.000000w/ADAM_MC1048576.png}}}
	
	\caption{Plots of the one-body density profile, $\rho$, for small quantum dots with frequency $\omega=1.0$. We look at the three lowest shells $S=1$, 2 and 3 seen from the top, corresponding to $N=2$, 6, and 12 electrons in two dimensions (2D) and $N=2$, 8 and 20 electrons in three dimensions (3D). In the first column, the surface plot and the contour plot on the $xy$-plane illustrate the density and the graph on the $yz$-plane represents the cross-section through $x=0$. In the middle column, the corresponding radial density profiles are obtained using RBM, RBM+SJ, RBM+PJ and VMC. In the last column, the radial density profiles for the three-dimensional dots are given using the same methods. ADAM optimizer was used, and after convergence, the number of Monte Carlo cycles was $M=2^{30}=1,073,741,824$. The surface plots are noise-reduced using a Savitzky-Golay filter. For  abbreviations and description of the natural units used, see the text.}
	\label{fig:OB_interaction_23D}
\end{figure}
\noindent
also observed in figures \eqref{fig:OB_interaction_1p0w1} and \eqref{fig:OB_interaction_1p0w2}. Further, the RBM+SJ is more similar to the VMC and RBM+PJ, which are almost identical. This is consistent with the energy analysis in section \ref{sec:groundstateenergy}, where we found VMC and RBM+PJ to be the most accurate methods, followed by RBM+SJ and RBM. We also observe some noise close to $r=0$, which is caused by the fact that the number of Monte Carlo cycles is finite and we in practice have bins of different sizes.

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{3cm}{\rotatebox[origin=t]{90}{$\omega=0.1$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=8cm]{../plots/int1/onebody/2D/20P/0.100000w/ADAM_MC1048576.png}}}\hspace{-0.5cm}
	\subfloat{{\includegraphics[width=8cm]{../plots/int1/onebody/2D/42P/0.100000w/ADAM_MC1048576.png}}}\\
	
	\subfloat{\raisebox{3cm}{\rotatebox[origin=t]{90}{$\omega=0.5$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=8cm]{../plots/int1/onebody/2D/20P/0.500000w/ADAM_MC1048576.png}}}\hspace{-0.5cm}
	\subfloat{{\includegraphics[width=8cm]{../plots/int1/onebody/2D/42P/0.500000w/ADAM_MC1048576.png}}}\\
	
	\subfloat{\raisebox{3cm}{\rotatebox[origin=t]{90}{$\omega=1.0$}}}\hspace{0.1cm}
	\subfloat[20P]{{\includegraphics[width=8cm]{../plots/int1/onebody/2D/20P/1.000000w/ADAM_MC1048576.png}}}\hspace{-0.5cm}
	\subfloat[42P]{{\includegraphics[width=8cm]{../plots/int1/onebody/2D/42P/1.000000w/ADAM_MC1048576.png}}}
	
	\caption{Plots of the one-body density profiles, $\rho(r)$, for two-dimensional quantum dots with $N=20$ (left column) and $N=42$ (right column) and oscillator frequencies $\omega=0.1$, 0.5 and 1.0 seen from the top. The ADAM optimizer was used, and after convergence the number of Monte Carlo cycles was $M=2^{28}=268,435,456$. For  abbreviations and description of the natural units used, see the text.}
	\label{fig:OB_interaction}
\end{figure}

We now move on to larger two-dimensional dots and frequencies lower than $\omega=1.0$ to see if the physics is conserved also when the correlations get stronger. In figure \eqref{fig:OB_interaction}, we plot the radial density profile for two-dimensional quantum dots with $N=20$ and 42, and frequencies $\omega=0.1$, 0.5 and 1.0 to compare all the methods again. What we see is that the peaks discussed above are conserved for lower frequencies, and they change slightly as the frequency drops. Also, the density distribution is spatially expanded as the frequency drops, since the force pushing the electrons towards the center of the dot gets weaker. All the methods VMC, RBM+PJ, and RBM+SJ appear to give quite similar density plots, but for lower frequencies, the difference gets gradually more visible. In particular, the peaks for frequency $\omega=0.1$ do no longer match for the various methods. Especially RBM and RBM+SJ differ from VMC and RBM+PJ, which is again a clear indication that the final results are heavily dependent on the way the methods account for the correlations. RBM+SJ tends to slightly exaggerate the peaks in the density plots, and RBM takes the exaggeration to the next level. This trend was also observed in the plots in figures (\ref{fig:OB_interaction_1p0w1}, \ref{fig:OB_interaction_1p0w2}, \ref{fig:OB_interaction_23D}), and technically speaking, this means that the method is capable of finding the most likely places to find the electrons, but fails to determine the actual density there. We have also seen that the one-body density is shape-invariant for the frequencies $\omega=0.5$ and 1.0 except for their radial extent. For that reason, it is not very exciting to further study those high frequencies, and in section \ref{sec:lowfrequencies} we move on to low-frequency dots.

\subsection{Two-body density}
We have on multiple occasions in this thesis discussed the electron density, and we have also mentioned the two-body density. The two-body density gives the probability of finding an electron at a certain position, given the position of another electron. Unlike the one-body density, this density gives, for example, information about how the electrons distribute pairwise, and how they correlate. This may leads to a better understanding of electron-electron correlations. Similar to the one-body density, we can plot both the radial two-body density profile and the actual two-body density distribution throughout the space. However, since the latter results in a higher-dimensional object, we stick to the radial density profile. We obtain this radial density as a function of the coordinates $r_i$ and $r_j$, and to present the density in an illustrative and intuitive way, we have mirrored the density three times around the lower-left corner. Therefore, we get a negative radial distance which otherwise would not make sense. Unlike the results presented above, we do not have any reference for our plots of the two-body density. We will focus on the two-dimensional case, as the three-dimensional case becomes similar in the same way as for the one-body density. 

In figure \eqref{fig:TB_interaction_2P}, we plot the two-body density for a two-dimensional quantum dot with $N=2$ and frequencies $\omega=0.1$, 0.5 and 1.0. For the frequency $\omega=1.0$, the density plots for all the methods provide similar results, but the RBM gives a higher two-body density in the middle of the quantum dot, compared to the other methods. The higher density can be seen from the magnitude of the density at the center, but also the density itself is narrower than for its fellow methods, making it more compact. Also, the RBM+SJ gives a slightly narrower distribution than the RBM+PJ and VMC, so it is apparent that the Padé-Jastrow factor results in a stronger repulsive force between the electrons. The same indication can be seen from the density at the origin, which is low for RBM+PJ and VMC, but high for RBM and RBM+SJ. Furthermore, we know that the potential, and thus the interaction energy, gets more dominating as the frequency drops. For VMC and RBM+PJ, this can be observed by a circle of significantly higher density at a certain distance from the origin, most notably for $\omega=0.1$, meaning that both electrons are less likely to be found at the center of the dot at the same time. If an electron is close to the center, the other electron is likely to be far from the center and \textit{vice versa}. For the RBM+SJ, this behavior can only be observed for $\omega=0.1$, while the RBM is not able to reproduce this phenomenon at all. This indicates that the RBM is not able to model the correlations correctly, and it needs a Jastrow factor to account for them. The resolutions of the plots get lower when we decrease the frequency, as the electrons spread over a larger area and therefore more bins.

\begin{landscape}
	\begin{figure}
		\centering
		\captionsetup{width=0.9\hsize}
		\captionsetup[subfigure]{labelformat=empty}
		\subfloat{\raisebox{2cm}{\rotatebox[origin=t]{90}{$\omega=0.1$}}}\hspace{0.1cm}
		\subfloat{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.100000w/RBM_ADAM_MC1048576.png}}}
		\subfloat{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.100000w/RBMSJ_ADAM_MC1048576.png}}}
		\subfloat{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.100000w/RBMPJ_ADAM_MC1048576.png}}
		\subfloat{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.100000w/VMC_ADAM_MC1048576.png}}}
		
		\subfloat{\raisebox{2cm}{\rotatebox[origin=t]{90}{$\omega=0.5$}}}\hspace{0.1cm}
		\subfloat{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.500000w/RBM_ADAM_MC1048576_zoomed.png}}}
		\subfloat{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.500000w/RBMSJ_ADAM_MC1048576_zoomed.png}}}
		\subfloat{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.500000w/RBMPJ_ADAM_MC1048576_zoomed.png}}
		\subfloat{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/0.500000w/VMC_ADAM_MC1048576_zoomed.png}}}\\
		
		\subfloat{\raisebox{2cm}{\rotatebox[origin=t]{90}{$\omega=1.0$}}}\hspace{0.1cm}
		\subfloat[RBM]{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/1.000000w/RBM_ADAM_MC1048576_zoomed.png}}}
		\subfloat[RBM+SJ]{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/1.000000w/RBMSJ_ADAM_MC1048576_zoomed.png}}}
		\subfloat[RBM+PJ]{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/1.000000w/RBMPJ_ADAM_MC1048576_zoomed.png}}}
		\subfloat[VMC]{{\includegraphics[width=5.7cm]{../plots/int1/twobody/2D/2P/1.000000w/VMC_ADAM_MC1048576_zoomed.png}}}
		
		\caption{Plots of the radial two-body density profiles, $\rho(r_i, r_j)$, for two-dimensional quantum dots with $N=2$ electrons and oscillator frequencies $\omega=0.1$, 0.5 and 1.0 seen from the top. The methods RBM, RBM+SJ, RBM+PJ and VMC (from the left) were used, with the ADAM optimizer and $M=2^{28}=268,435,456$ Monte Carlo cycles after convergence. For  abbreviations and description of the natural units used, see the text.}%
		\label{fig:TB_interaction_2P}
	\end{figure}
\end{landscape}
\begin{figure}[H]
	\centering
	\captionsetup{width=0.9\hsize}
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=6$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=7cm]{../plots/int1/twobody/2D/6P/0.500000w/RBM_ADAM_MC1048576.png}}}
	\subfloat{{\includegraphics[width=7cm]{../plots/int1/twobody/2D/6P/0.500000w/VMC_ADAM_MC1048576.png}}}\\
	
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=20$}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=7cm]{../plots/int1/twobody/2D/20P/0.500000w/RBM_ADAM_MC1048576.png}}}
	\subfloat{{\includegraphics[width=7cm]{../plots/int1/twobody/2D/20P/0.500000w/VMC_ADAM_MC1048576.png}}}\\
	
	\subfloat{\raisebox{2.5cm}{\rotatebox[origin=t]{90}{$N=42$}}}\hspace{0.1cm}
	\subfloat[RBM]{\includegraphics[width=7cm]{../plots/int1/twobody/2D/42P/0.500000w/RBM_ADAM_MC1048576.png}}
	\subfloat[VMC]{{\includegraphics[width=7cm]{../plots/int1/twobody/2D/42P/0.500000w/VMC_ADAM_MC1048576.png}}}
	
	\caption{Plots of the two-body density profiles, $\rho(r_i, r_j)$, for two-dimensional quantum dots with an even number of closed shells ($N=6$, 20 and 42 electrons from the top) and oscillator frequency $\omega=0.5$. The methods RBM (left column) and VMC (right column) were used, with the ADAM optimizer and $M=2^{28}=268,435,456$ Monte Carlo cycles after convergence. For  abbreviations and description of the natural units used, see the text.}%
	\label{fig:TB_interaction_20P}
\end{figure}

We also present plots of the two-body density of two-dimensional quantum dots with frequency $\omega=0.5$ and an even number of closed shells ($N=6$, 20 and 42). For the simulations, we use RBM and VMC, and the plots are found in figure \eqref{fig:TB_interaction_20P}. The first thing we observe is that the RBM manages to obtain the correct peaks, but all the peaks are circular, unlike the density plots from the VMC, and they are also more distinct and higher than for VMC. This is the same effect we saw from the one-body density plots, where we argued the the effect was caused by the different ways of modeling the correlations. If we now keep our attention on the VMC plots, it is apparent that two electrons will not be observed in the center of the dot at the same time, as the density there is almost absent. For $N=6$, an electron pair is most likely to be found at the same radius around $r=2$, which matches the one-body density plot. When we move on to $N=20$, the most probable location is not ambiguous anymore, but an electron pair is likely to be found at the same radius at around $r=1$, which matches the highest peak in the one-body density plot. However, the density is also high along both axes, which means that if one of the electrons moves towards the center of the dot, the other will also move towards the center. This is probably a consequence of the repulsive interactions. For $N=42$, finding two electrons at the same radius is not the most likely case anymore. This is because the electrons now spread over a large area. The density plot clearly has some distinct peaks around $r_i\sim 2.5$ and $r_j\sim 1$, matching the peaks found in the one-body density plots. For dots with an odd number of closed shells, the same tendency was found, but the peaks were found at the intersection between the quadrants, again matching the one-body density.

\iffalse
\begin{figure}[H]
	\centering 
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat[RBM]{{\input{pgf/RBM_2D.tex}}}
	\subfloat[RBM+SJ]{{\input{pgf/RBMSJ_2D.tex}}}\\
	\subfloat[RBM+PJ]{{\input{pgf/RBMPJ_2D.tex}}}
	\subfloat[VMC]{{\input{pgf/VMC_2D.tex}}}
	\caption{The kinetic-potential energy ratio $\langle\hat{T}\rangle/\langle\hat{V}\rangle$ plotted as a function of the oscillator frequency for two-dimensional circular quantum dots. The frequencies $\omega=0.01, 0.1, 0.28, 0.5, 1.0, 2.0, 3.0, 5.0, 10.0$ were run. For abbreviations see the text.}
	\label{fig:energysplitVMC2D}
\end{figure}
\fi

\subsection{Energy distribution} \label{sec:energydistributions}
If we now recall the general Hamiltonian presented in chapter \ref{chp:manybody}, the total energy is just the sum of the kinetic, potential, and interaction energy. As our methods attempt to solve the Schrödinger equation directly, it is trivial to find the distribution between the various energy sources, which in general is interesting when we want to find the most important contributions to the energy. Additionally, we can use these results to attempt to verify the virial theorem presented in section \ref{sec:virial}. It is also interesting to see if the different methods give different energy distributions. In figure \eqref{fig:energydistribution}, we plot the ratio between the kinetic and potential energy as a function of oscillator frequency for two-dimensional quantum dots with up to $N=20$ electrons for all our methods. The plots are based on the numbers in the tables (\ref{tab:splitfrequencyQDRBM}-\ref{tab:splitfrequencyQDVMC}) in appendix \ref{chp:totalresults}. 

\input{../pgf/energy_distribution.tex}

Firstly, the graphs are very similar for all the methods, which means that they all give the same distribution between kinetic and potential energy, although they do not provide the same energy. This is an interesting observation and means that the obtained kinetic and potential energy are both different for the various methods when the total energy is different. Physically, this indicates that the electron configurations are fundamentally different for the different methods, which is the only factor that can cause a change in potential energy. This is already observed in the one-body density plots. Further, we see a significant trend where the ratio drops as the frequency is decreased, implying that the potential energy dominates over the kinetic energy at low frequencies, which is a known phenomenon already mentioned several times throughout this thesis. For all the methods, the ratio is also lower for larger dots, which is a result of gradually more interaction energy as the number of electrons increases.

\begin{table}
	\caption{The ground state energy, $E$, of two-dimensional quantum dots with $N=12$ electrons and frequency $\omega$. In the following columns, the distribution between kinetic, $\langle\hat{T}\rangle$, external potential, $\langle\hat{V}_{\text{ext}}\rangle$, and interaction, $\langle\hat{V}_{\text{int}}\rangle$, energy are presented. The energy is given in units of $\hbar$ (natural units), and the numbers in parenthesis are the statistical uncertainties in the last digit. For abbreviations see the text.}
	\label{tab:splitfrequencyQD20P}
	\begin{tabularx}{\textwidth}{R{0.5cm}rrcR{2.3cm}R{2.3cm}R{2.3cm}R{2.3cm}R{0.3cm}} \hline\hline
		&\makecell{\\ \phantom{$N$}} & $\omega$ && \multicolumn{1}{c}{$E$} & \multicolumn{1}{c}{$\langle \hat{T}\rangle$} & \multicolumn{1}{c}{$\langle \hat{V}_{\text{ext}} \rangle$} & \multicolumn{1}{c}{$\langle \hat{V}_{\text{int}} \rangle$} \\ \hline \\
		&RBM & 0.01 && 6.217(2) & 0.1236(4) & 2.244(2) & 3.849(2) \\
		&& 2.0 && 269.086(8) & 43.262(8) & 95.17(2) & 130.65(1) \\
		&& 10.0 && 961.03(4) & 260.2(1) & 364.8(1) & 336.06(7) \\
		\hline \\
		
		&RBM+SJ & 0.01 && 6.239(2) & 0.1372(6) & 2.184(2) & 3.919(3) \\
		&& 2.0 && 265.66(9) & 39.31(8) & 95.78(1) & 130.57(2) \\
		&& 10.0 && 952.71(2) & 237.65(4) & 392.06(7) & 323.00(3) \\
		\hline \\
		
		&RBM+PJ & 0.01 && 6.210(1) & 0.1208(5) & 2.189(2) & 3.900(2) \\
		&& 2.0 && 262.598(1) & 34.758(6) & 108.546(9) & 119.293(7) \\
		&& 10.0 && 947.33(2) & 257.67(5) & 348.35(6) & 341.31(3) \\ 
		\hline \\
		
		&VMC & 0.01 && 6.2097(8) & 0.1005(4) & 2.270(3) & 3.839(3) \\
		&& 2.0 && 262.5339(9) & 38.402(3) & 95.681(7) & 128.451(5) \\
		&& 10.0 && 945.596(8) & 231.56(4) & 389.26(7) & 324.77(3) \\
		\hline\hline
	\end{tabularx}
\end{table}

If we further recall the virial theorem presented in section \ref{sec:virial}, it states that the kinetic energy is related to the potential energies in a certain way. We have tested the virial theorem for the non-interacting case and verified the virial theorem: $\langle\hat{V}\rangle=\langle\hat{V}_{\text{ext}}\rangle$. When we do the same calculation for the correlating quantum dots, we find the relation to not be satisfied,
\begin{empheq}[box={\mybluebox[5pt]}]{equation}
\langle \hat{T} \rangle\neq \langle\hat{V}_{\text{ext}}\rangle.
\label{eq:virialoff}
\end{empheq}
This can be seen from table \eqref{tab:splitfrequencyQD20P}, where we present the energy distribution for $N=12$ and selected frequencies. Especially for low frequency dots, the kinetic energy is dominated by the potential energy. When the frequency is increased, the interacting energy contributes less and the kinetic and potential energy approach each other. Based on this, we believe that $\langle\hat{T}\rangle\simeq\langle\hat{V}_{\text{ext}}\rangle$ when $\omega\rightarrow\infty$. This can also be seen from figure \eqref{fig:energydistribution}, as the graphs flatten out as the frequency increases. 

Furthermore, the modified virial theorem, $\langle\hat{V}\rangle=\langle\hat{V}_{\text{ext}}\rangle$, is only valid in the exact wave function basis of the system. This is a consequence of the exponential rate of the operators. For quantum dots, the kinetic energy operator goes as $\hat{T}\propto r^{-2}$, while the potential energy operator goes as $\hat{V}_{\text{ext}}\propto r^2$. This means that the kinetic energy is deeply sensitive about the ends of the wave function and the potential energy is sensitive about the center. The result is that both the ends and the center of the wave function need to be correct in order to verify the virial theorem. Physically, this means that an energy close to the ground-state energy can be obtained even when the contribution from the various energy sources is wrong. For that reason, a low energy does not guarantee the correct wave function. It is difficult to know which distribution is the correct one, but for high frequencies the virial theorem provides an indication.

\iffalse
If we assume that the interaction potential goes as $V_{\text{int}}\propto r^{-1}$, we can write the virial theorem as
\begin{empheq}[box={\mybluebox[5pt]}]{equation}
2\langle \hat{T} \rangle=2\langle \hat{V}_{\text{ext}} \rangle-\langle \hat{V}_{\text{int}} \rangle,
\label{eq:modifiedvirial}
\end{empheq}
according to equation \eqref{eq:simplevirial}. We could try to verify this formula from figure \eqref{fig:energydistribution}, but in order to do this accurately, we will list up the energy distributions for some selected systems. For a two-dimensional quantum dot with $N=20$ electrons the energy distribution is given in table \eqref{tab:splitfrequencyQD20P} for some selected frequencies. By doing the math, we see that the virial theorem is not satisfied for any of the methods or frequencies! For the lowest frequency, the theorem is far from being correct, but as the frequency increases the error decreases. To estimate the accuracy of the theorem, we introduce a ratio
\begin{equation}
R=\frac{2\langle\hat{T}\rangle}{2\langle\hat{V}_{\text{ext}}\rangle-\langle\hat{V}_{\text{int}}\rangle},
\end{equation}
which is naturally $R_{\text{exact}}=1$ if our version of the virial theorem is satisfied. To estimate the error, we calculate the absolute error $E_{\omega}=||R_{\omega}-1||$. Take, for example VMC, we get $E_{\omega=0.01}=0.713$, $E_{\omega=2}=0.221$ and $E_{\omega=10}=0.021$, which shows that equation \eqref{eq:modifiedvirial} gradually gets more accurate as the potential energy gets more important. To see why this is the case, we need to go back to the original virial theorem given in equation \eqref{eq:virialtheorem}. By inserting the interaction energy, we see that our modified virial theorem is inaccurate, and breaks down when the interaction energy dominates. However, it should be quite accurate when the interaction energy is irrelevant, which is consistent with our results. 
\fi

Another interesting aspect is how the energy is distributed for the various methods. Most notably, we see that VMC and RBM+PJ provide different distributions between the different methods, albeit the total energy is more or less identical. Physically, this means that the RBM+PJ finds another configuration than VMC to minimize the energy, which is exciting as the former method is supposed to be more flexible than the latter. For more frequencies and system sizes, please look at appendix \ref{chp:totalresults}.

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{RBM}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.100000w/RBM_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.100000w/RBM_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/12P/0.100000w/RBM_ADAM_MC1048576.png}}}\\ [-0.cm]
	
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{VMC}}}\hspace{0.1cm}
	\subfloat[$N=2$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.100000w/VMC_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat[$N=6$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.100000w/VMC_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat[$N=12$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/12P/0.100000w/VMC_ADAM_MC1048576.png}}}
	
	\caption{Plots of the one-body density profile, $\rho(x, y)$, of two-dimensional quantum dots with frequency $\omega=0.1$ and $N=2$, 6 and 12 electrons seen from left to right. The methods used are RBM (upper plots) and VMC (lower plots). The surface plot and the contour plot on the $xy$-plane illustrate the density, and the graph on the $yz$-plane represents the cross-section through $x=0$. The surface plots are noise-reduced using a Savitzky-Golay filter. For abbreviations and description of the natural units used, see the text.}
	\label{fig:lowfreqRBM}
\end{figure}

\newpage
\subsection{Low frequency dots} \label{sec:lowfrequencies}
In section \ref{sec:onebodyresults}, we found the one-body density to be shape-invariant for high-frequency dots with $\omega\geq0.28$. However, when we further decreased the frequency down to $\omega=0.1$, the density profiles changed significantly, and we got other extrema. This section aims to investigate the transitions between the various shapes with frequencies down to $\omega=0.01$. At this points, it is important to recall that our choice of the trial wave function is a single Slater determinant. This is not necessarily a good approximation for these low-frequency dots, as the gaps between the excited states around the Fermi level is small. 

We start by looking at quantum dots with frequency $\omega=0.1$, and in figure \eqref{fig:lowfreqRBM} we compare the radial density profiles for $N=2$, 6 and 12 produced by RBM to the results produced by VMC. What we observe is that the density plots are completely different. While VMC provides a single peak with some bumps on the top, RBM gives several peaks for all the numbers of electrons. The numbers of peaks apparently is equal to the number of electrons, which indicates that the RBM finds the electrons to be localized at some fixed spots. The two methods model the correlations in completely different ways, and as the correlations become more important for low frequencies, it was expected that the results would also be different. However, the obtained ground state energies by the two methods are not so different for the same systems, indicating that the electron density plots are better to reveal differences between the methods than the energy itself. 

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{RBM+PJ}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.280000w/RBMPJ_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.100000w/RBMPJ_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.010000w/RBMPJ_ADAM_MC2pow28_smooth_blue_small.png}}}\\ [-0.cm]
	
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{VMC}}}\hspace{0.1cm}
	\subfloat[$\omega=0.28$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.280000w/VMC_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat[$\omega=0.1$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.100000w/VMC_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat[$\omega=0.01$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/2P/0.010000w/VMC_ADAM_MC2pow28_smooth_blue_small.png}}}
	
	\caption{Plots of the one-body density profile, $\rho(x, y)$, of two-dimensional quantum dots with $N=2$ electrons and frequencies $\omega=0.28$, 0.1 and 0.01 from left to right. The methods used are RBM+PJ (upper plots) and VMC (lower plots). The surface plot and the contour plot on the $xy$-plane illustrate the density, and the graph on the $yz$-plane represents the cross-section through $x=0$. The surface plots are noise-reduced using a Savitzky-Golay filter. For  abbreviations and description of the natural units used, see the text.}
	\label{fig:lowfreq2P}
\end{figure}

Further, we fix the number of electrons to be $N=2$, and vary the frequency from $\omega=0.28$ down to $\omega=0.01$ with density profiles produced by VMC and RBM+PJ found in figure \eqref{fig:lowfreq2P}. These methods were selected as they hitherto have shown the most promising results and we want to see if the RBM+PJ can reveal effects that the VMC is not able to capture. We see that the two methods obtain very similar density plots, where they agree that a ridge around the center of the dot should be more distinct as the frequency drops. If we go back to figure \eqref{fig:energydistribution}, we saw that the kinetic energy was negligible for the lowest energies, and the effect is, therefore, an indication of the Wigner localization effect discussed in section \ref{sec:wigner}. As in the classical limit, the two electrons will repel each other and seldom be located at the same place when their kinetic energy is low. RBM+PJ possibly provides a sharper ridge for $\omega=0.01$, which is closer to the DMC results found from \citet{hogberget_quantum_2013} and thus perhaps more correct. However, the energy provided by RBM+PJ and VMC are more or less identical ($E=0.074107$ and $E=0.074070$, respectively), which means that the difference in one-body density does not affect to the energy.

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{RBM+PJ}}}\hspace{0.1cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.280000w/RBMPJ_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.100000w/RBMPJ_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.010000w/RBMPJ_ADAM_MC1048576.png}}}\\ [-0.cm]
	
	\subfloat{\raisebox{1.5cm}{\rotatebox[origin=t]{90}{VMC}}}\hspace{0.1cm}
	\subfloat[$\omega=0.28$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.280000w/VMC_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat[$\omega=0.1$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.100000w/VMC_ADAM_MC1048576.png}}}\hspace{-0.cm}
	\subfloat[$\omega=0.01$]{{\includegraphics[width=5.1cm]{../plots/int1/onebody2/2D/6P/0.010000w/VMC_ADAM_MC2pow28_smooth}}}
	
	\caption{Plots of the one-body density profile, $\rho(x, y)$, of two-dimensional quantum dots with $N=6$ electrons and frequencies $\omega=0.28$, 0.1 and 0.01 seen from left to right. The methods used are RBM+PJ (upper plots) and VMC (lower plots). The surface plot and the contour plot on the $xy$-plane illustrate the density, and the graph on the $yz$-plane represents the cross-section through $x=0$. The surface plots are noise-reduced using a Savitzky-Golay filter. For  abbreviations and description of the natural units used, see the text.}
	\label{fig:lowfreq6P}
\end{figure}

We repeat the exercise for quantum dots with $N=6$ electrons, and obtain the plots in figure \eqref{fig:lowfreq6P}. With VMC, we observe the same tendency as for the dots with $N=2$ electrons, where we get an additional peak in the density plot as the frequency decreases. However, for RBM+PJ, we do not get this peak in the center, but rather a significant density drop. This is contrary to the DMC one-body density plots obtained by \citet{hogberget_quantum_2013}, where there is a sharp peak in the center. The density plot for quantum dots is also known to approach the classical limit as the frequency is decreased \supercite{ghosal_incipient_2007}, where the potential energy is minimized when we have one electron in the center and five electrons surrounding it.

In order to give a more qualitative comparison of the various methods, we also present the radial one-body density profile of the quantum dots of frequency $\omega=0.01$ with $N=2$ and $N=6$ electrons, see figure \eqref{fig:lowfreq}. We see that all the methods agree for $N=2$, where RBM+PJ gives the most distinct peak, followed by VMC, RBM+SJ and RBM. For $N=6$, however, the various methods give completely different density profiles.

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat{{\includegraphics[width=\textwidth/2]{../plots/int1/onebody/2D/2P/0.010000w/ADAM_MC1048576.eps}}}
  	\subfloat{{\includegraphics[width=\textwidth/2]{../plots/int1/onebody/2D/6P/0.010000w/ADAM_MC10485762.eps}}}
	
	\caption{Plots of the one-body density profile, $\rho(r)$, of two-dimensional quantum dots of frequency $\omega=0.01$ and $N=72$, 90. The ADAM optimizer was used, and after convergence the number of Monte Carlo cycles was $M=2^{28}=268,435,456$. For abbreviations and description of the natural units used, see the text.}
	\label{fig:lowfreq}
\end{figure}

\subsection{Large dots}
In order to test the code, we also decided to run for systems with $N>56$. We do this in sake of completeness and to test how far a VMC code can go. One thing is that the computations get extremely expensive as the number of electrons increases, but we have also seen that the statistical error increases as the system size increases. This means that we cannot just crack up the wall clock time and wait when studying large systems; at some point, the standard error gets insufficiently large, and we need to increase the number of Monte Carlo cycles further. The learning rate also needs to be decreased as the system sizes increase, which requires more iterations.  We look at weakly interacting electrons, so we will not get any relativistic effects even when adding many electrons. In table \eqref{tab:largeQD}, the ground state energy of two-dimensional quantum dots with frequency $\omega=1.0$, and $N=72$ and 90 electrons and three-dimensional quantum dots with $N=70$ electrons is listed. We observe that the difference between VMC and RBM is quite significant, especially for $N=90$ electrons in two dimensions. We suspect that this simulation simply has not converged. 

\begin{table}
	\caption{Ground state energy of large quantum dots with frequency $\omega=1.0$ and $N=72$ and 90 electrons in two dimensions (2D) and $N=70$ electrons in three dimensions (3D). All energies are given in units of $\hbar$ (natural units), and the numbers in parenthesis are the statistical uncertainties in the last digit. For abbreviations see the text.}
	\label{tab:largeQD}
	\begin{tabularx}{\textwidth}{R{1.6cm}R{2cm}R{2cm}R{3cm}R{3cm}} \hline\hline
		& \makecell{\\ \phantom{$N$}} & $N$ & RBM & VMC \\ \hline \\
		& 2D & 72 & 1355.37(2) & 1340.520(7) \\
		&& 90 & 2194.12(9) & 1990.89(2) \\
		& 3D & 70 & 1129.40(2) & 1108.950(4) \\
		\hline \hline
	\end{tabularx}
\end{table}

In figure \eqref{fig:largedotsOB}, the radial one-body density profile is plotted for two-dimensional quantum dots with frequency $\omega=1.0$ and $N=72$, 90 electrons. Again, we observe the same peaks as we observed in section \ref{sec:onebodyresults}, and the number of peaks substantiates that we get an additional peak every time we add a closed-shell. However, for $N=90$, the peaks are not as significant as before, most notably for the RBM, which is another indication that the simulation has not converged.

\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat[$N=72$]{\includegraphics[width=8cm]{../plots/int1/onebody/2D/72P/1.000000w/ADAM_MC1048576.png}}\hspace{-0.5cm}
	\subfloat[$N=90$]{\includegraphics[width=8cm]{../plots/int1/onebody/2D/90P/1.000000w/ADAM_MC1048576.png}}\\
	\caption{Plots of the radial one-body density profile, $\rho(r)$, of large quantum dots with $N=72$ (left) and 90 (right), and frequency $\omega=1.0$ produced with RBM and VMC. For abbreviations and description of the natural units used, see the text.}
	\label{fig:largedotsOB}
\end{figure}

\section{Atoms}\label{sec:atomsresults}
The last systems we will address are the real atoms, which have been investigated by physicists since the childhood of quantum mechanics. This section is added to show the flexibility of the implemented code, which can easily be expanded to new systems. The simple hydrogen-like orbitals, detailed in section \ref{sec:atomic}, are used. We investigate the four selected atoms: Helium, beryllium, neon and magnesium. These atoms were not selected arbitrary; helium and neon are the two smallest noble gases and are thus closed-shell systems. Beryllium and magnesium are, on the other hand, not closed-shell systems, but since the valence electrons might occupy the $s$-shell in the ground state, a single Slater determinant as the trial wave function guess might be a reasonable guess. In table \eqref{tab:atomswinteraction}, the obtained ground state energy is obtained, including an overview of how the energy is distributed and the ratio between the kinetic and potential energy. We also compare the obtained results to experimental values. 

We observe that the total energy is similar, but slightly higher than our reference, which is as expected as we use a simple basis. Magnesium is the atom where we get largest deviation between the obtained and the experimental energy, which indicates that the single Slater determinant is not a sufficient trial wave function ansatz for this system.

\begin{table}[H]
	\caption{Ground state energy, $E$, of neutral atoms with atomic number, $Z$, produced by the VMC method. In the following columns, the distribution between kinetic, $\langle\hat{T}\rangle$, external potential, $\langle\hat{V}_{\text{ext}}\rangle$, and interaction, $\langle\hat{V}_{\text{int}}\rangle$, energy are presented, as well as the kinetic-potential energy ratio, $\langle\hat{T}\rangle/\langle\hat{V}\rangle$. The experimental energies (Expr.) are taken from \citet{degroote_faddeev_2013}, table 4.4. The energy is given in Hartree atomic units, and the numbers in parenthesis is the statistical error. For abbreviations and description of the units, see the text.}
	\label{tab:atomswinteraction}
	\begin{tabularx}{\textwidth}{lrrR{2cm}R{1.9cm}|R{1.7cm}R{1.7cm}R{1.7cm}R{1.7cm}} \hline\hline
		Atom & $Z$ & \makecell{\\ \phantom{=} \\ \phantom{=}} & 
		\multicolumn{1}{c}{\makecell{Expr.\\ (Ref.\cite{degroote_faddeev_2013})}} & \multicolumn{1}{c}{$E$} & \multicolumn{1}{c}{$\langle\hat{T}\rangle$} & \multicolumn{1}{c}{$\langle\hat{V}_{\text{ext}}\rangle$} & \multicolumn{1}{c}{$\langle\hat{V}_{\text{int}}\rangle$} & \multicolumn{1}{c}{$\langle\hat{T}\rangle/\langle\hat{V}\rangle $} \\ \hline \\
		
		He & 2 && -2.9037 & -2.8719(3) & 2.813(3) & -6.696(4) & 1.010(7) & -0.495 \\
		Be & 4 && -14.6674 & -14.4992(5) & 15.465(6) & -34.987(7) & 5.023(1) & -0.516 \\
		Ne & 10 && -128.9383 & -128.09(1) & 133.4(2) & -318.4(2) & 56.94(5) & -0.510 \\ 
		Mg & 12 && -200.054 & -196.81(4) & 251.9(2) & -557.0(2) & 108.23(6) & -0.379 \\ \hline\hline
	\end{tabularx}
\end{table}

If we once again recall the virial theorem first introduced in section \ref{sec:virial}, it reads
\begin{empheq}[box={\mybluebox[5pt]}]{equation}
2\langle\hat{T}\rangle = -\langle\hat{V}_{\text{ext}}\rangle
\label{eq:virialatom}
\end{empheq}
for non-interaction atoms, for which the equation has been verified. For interacting atoms, equation \eqref{eq:virialatom} is not valid, but based on table \eqref{tab:atomswinteraction} it is closer than what we observed for the two-dimensional quantum dots in section \ref{sec:energydistributions}. As the quantum dots became weaker interacting, the modified virial theorem got more correct. Moreover, in section \ref{sec:groundstateenergy} we observed that a two-dimensional system is more sensitive about the wave function gues than a three-dimensional system. As atoms are three-dimensional, we expected the virial theorem to be more correct than for two-dimensional systems. 

\iffalse
If we once again recall the virial theorem first introduced in section \ref{sec:virial}, it reads
\begin{empheq}[box={\mybluebox[5pt]}]{equation}
2\langle\hat{T}\rangle = -(\langle\hat{V}_{\text{ext}}\rangle + \langle\hat{V}_{\text{int}}\rangle)
\label{eq:virialratio}
\end{empheq}
for atoms and molecules under the assumption that $V_{\text{int}}\propto r^{-1}$. For quantum dots, we found this assumption to be inaccurate, and our modified virial theorem broke down for strongly interacting systems. To see if the same happens fro atoms, we again introduce the ratio between the kinetic and potential energy, $R=\langle\hat{T}\rangle/\langle\hat{V}\rangle$, which for this system should be $R=-0.5$ in order to fulfill equation \eqref{eq:virialratio}. In the last column of table \ref{tab:atomswinteraction}, this ratio is presented for the various atoms, and for helium, beryllium and neon we see that the ratio actually is close to -0.5. However, for magnesium, the value is off, which could either be a result of too strong attraction force from the nucleus or some errors in the calculations. We believe that it is the latter, as we get an accurate result with neon, and perhaps the model has just not converged. 
\fi
\begin{figure}
	\centering
	\captionsetup[subfigure]{labelformat=empty}
	\subfloat[helium]{\includegraphics[width=\textwidth/2]{../plots/int1/atoms/He/ADAM_MC2pow28.png}}
	\subfloat[beryllium]{\includegraphics[width=\textwidth/2]{../plots/int1/atoms/Be/ADAM_MC2pow28.png}}\\
	\subfloat[neon]{\includegraphics[width=\textwidth/2]{../plots/int1/atoms/Ne/ADAM_MC2pow28.png}}
	\subfloat[magnesium]{\includegraphics[width=\textwidth/2]{../plots/int1/atoms/Mg/ADAM_MC2pow28.png}}
	\caption{Plots of the radial one-body density profiles, $\rho(r)$, as a function of the radial distance from the nucleus, multiplied with the radius squared. We look at the helium atom (upper left), the beryllium atom (upper right), the neon atom (lower left) and the magnesium atom (lower right). VMC was used, which is detailed in the text. The number of Monte Carlo cycles used was $M=2^{28}=268,435,456$ and the ADAM optimizer was used. Hartree atomic units were used, see the text.}
	\label{fig:atomsonebody}
\end{figure}

Furthermore, we look at the radial one-body density profiles, which are presented in figure \eqref{fig:atomsonebody} for our four atoms. To reveal peaks in the plots of the one-body density, they are multiplied with $r^2$ similar to, for example, \citet{hogberget_quantum_2013}. We observe that the densities agree with his DMC results, which again substantiates that our framework and electron density computations work as they should. However, for magnesium, the density plot is slightly different, which again indicates that the single Slater determinant is not a sufficient trial wave function ansatz for this system. 
