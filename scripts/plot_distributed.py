import numpy as np
import matplotlib.pyplot as plt
import tikzplotlib

plt.style.use("bmh")

def plot_ratio(data, w, systems, labels):
    data = np.array(data)
    
    for system in systems:
        potential = data[system, :, 2] + data[system, :, 3]
        kinetic = data[system, :, 1]
        ratio = np.divide(kinetic, potential)
        
        plt.plot(w, ratio, label=labels[system])
    size = 16
    label_size = {"size":str(size)}
    plt.rcParams["font.family"] = "Serif"
    
    plt.gcf().subplots_adjust(bottom=0.15)
    plt.gcf().subplots_adjust(left=0.18)

    plt.xlabel("$\omega$", **label_size)
    plt.ylabel(r"$\frac{\langle\hat{T}\rangle}{\langle\hat{V}\rangle}$", rotation=0, labelpad=10, **label_size)
    plt.legend(loc="best", fontsize=size)
    #plt.show()

if __name__ == "__main__":
    w = [0.01, 0.1, 0.28, 0.5, 1.0, 2.0, 3.0, 5.0, 10.0]
    
    system = "RBM_2D"
    
    ## --- TWO DIMENSIONS ---
    labels = ["2P", "6P", "12P", "20P"]
    VMC_2D = [[[0.074070, 0.00947, 0.02732, 0.03728],
        [0.44129, 0.09117, 0.1789, 0.17119],
        [1.02192, 0.2477, 0.4256, 0.3487],
        [1.65974, 0.4346, 0.7057, 0.5195],
        [2.99936, 0.8523, 1.3149, 0.8321],
        [5.49689, 1.811, 2.403, 1.283],
        [7.88401, 2.732, 3.500, 1.652],
        [12.50405, 4.619, 5.629, 2.255],
        [23.65035, 9.529, 10.538, 3.583]],

        [[0.6982, 0.02735, 0.2427, 0.4281],
        [3.5695, 0.3201, 1.2934, 1.9560],
        [7.6219, 0.9105, 2.8821, 3.8292],
        [11.8104, 1.6710, 4.535, 5.6045],
        [20.1918, 3.405, 8.046, 8.741],
        [35.0734, 7.751, 13.846, 13.476],
        [48.8728, 12.016, 19.682, 17.175],
        [74.9356, 20.796, 31.043, 23.097],
        [136.1522, 43.712, 58.20, 34.240]],

        [[2.4972, 0.05506, 0.858, 1.584],
        [12.3196, 0.6885, 4.393, 7.238],
        [25.7049, 2.090, 9.355, 14.260],
        [39.2421, 3.939, 14.564, 20.739],
        [65.7026, 9.246, 23.079, 33.378],
        [111.86, 20.22, 40.04, 51.605],
        [154.206, 29.701, 60.74, 63.763],
        [232.818, 56.157, 88.18, 88.478],
        [415.056, 112.99, 173.91, 128.15]],

        [[6.2097, 0.1005, 2.270, 3.839],
        [30.086, 1.243, 10.587, 18.257],
        [62.0755, 3.902, 22.228, 35.946],
        [94.0433, 7.823, 33.938, 52.282],
        [156.102, 16.86, 58.14, 81.098],
        [262.0, 39.3, 93.57, 129.05],
        [358.927, 61.017, 133.99, 163.924],
        [542.680, 127.77, 177.89, 237.12],
        [944.1, 234.4, 383.9, 325.9]]]
    
    RBM_2D = [[[0.078643, 0.009835, 0.031930, 0.03688],
        [0.4743, 0.08102, 0.2082, 0.1851],
        [1.0707, 0.2047, 0.4678, 0.3983],
        [1.7234, 0.3739, 0.7611, 0.5884],
        [3.0805, 0.7915, 1.3673, 0.9217],
        [5.5936, 1.6377, 2.5507, 1.4051],
        [7.9859, 2.5215, 3.6733, 1.7910],
        [12.6141, 4.2752, 5.9493, 2.3896],
        [23.7748, 9.063, 11.132, 3.580]],

        [[0.7072, 0.033, 0.2660, 0.4080],
        [3.7337, 0.3251, 1.4070, 2.002],
        [7.9273, 0.8684, 3.009, 4.050],
        [12.241, 1.611, 4.709, 5.921],
        [20.716, 3.391, 7.914, 9.411],
        [36.383, 8.311, 13.705, 14.367],
        [49.415, 10.309, 21.456, 17.649], 
        [76.801, 23.50, 27.33, 25.967],
        [137.338, 45.25, 55.75, 36.336]],

        [[2.5106, 0.0682, 0.893, 1.549],
        [12.703, 0.790, 4.681, 7.232],
        [26.564, 2.254, 9.635, 14.675],
        [40.442, 4.116, 14.868, 21.458],
        [67.614, 8.953, 25.207, 33.455],
        [115.214, 20.760, 43.69, 50.764],
        [158.145, 33.020, 59.72, 65.407],
        [239.527, 58.22, 93.92, 87.39],
        [435.36, 114.61, 200.13, 120.62]],

        [[6.217, 0.1236, 2.244, 3.849],
        [32.308, 1.708, 7.680, 22.919],
        [63.788, 4.443, 22.707, 36.638],
        [96.491, 8.144, 34.953, 53.394],
        [159.645, 17.12, 58.74, 83.397],
        [269.086, 43.262, 95.17, 130.65],
        [362.52, 57.005, 148.08, 157.43],
        [551.21, 115.12, 219.12, 216.97],
        [1003.71, 218.87, 492.87, 291.97]]]
        
    RBMSJ_2D = [[[0.075267, 0.00738, 0.03071, 0.03718],
        [0.44858, 0.07539, 0.1990, 0.1742],
        [1.03470, 0.2163, 0.4547, 0.3637],
        [1.67636, 0.3967, 0.7366, 0.5430],
        [3.0213, 0.8120, 1.3623, 0.8469],
        [5.5254, 1.6572, 2.5447, 1.3234],
        [7.9103, 2.5627, 3.664, 1.6840],
        [12.5322, 4.369, 5.890, 2.2838],
        [23.6773, 9.062, 11.208, 3.408]],

        [[0.7006, 0.0376, 0.2467, 0.4163],
        [3.6458, 0.2376, 1.3652, 2.043],
        [7.7347, 0.7603, 3.000, 3.974],
        [11.9392, 1.4801, 4.678, 5.781],
        [20.3393, 3.308, 7.983, 9.048],
        [35.2446, 7.098, 14.587, 13.560],
        [49.050, 11.164, 20.6469, 17.240],
        [75.116, 19.661, 32.283, 23.172],
        [136.331, 41.65, 60.53, 34.152]],

        [[2.4950, 0.07, 0.845, 1.58],
        [12.5964, 0.4520, 4.644, 7.500],
        [26.340, 1.917, 10.006, 14.417],
        [39.6340, 3.4852, 14.948, 21.201],
        [66.1898, 7.8777, 25.822, 32.490],
        [112.502, 18.118, 44.118, 50.201],
        [154.521, 28.050, 63.84, 62.634],
        [234.110, 52.86, 94.50, 86.75],
        [415.384, 108.57, 181.90, 124.92]],

        [[6.239, 0.1372, 2.184, 3.919],
        [30.624, 1.487, 10.893, 18.243],
        [62.786, 3.190, 22.782, 36.814],
        [94.755, 6.709, 34.845, 53.200],
        [156.816, 15.340, 59.931, 81.545],
        [265.66, 39.31, 95.78, 130.57],
        [360.630, 58.36, 141.54, 160.72],
        [543.06, 112.38, 210.52, 220.15],
        [952.71, 237.65, 392.06, 323.00]]]
        
    RBMPJ_2D = [[[0.074107, 0.01031, 0.02703, 0.03677],
        [0.440975, 0.09223, 0.1757, 0.17304],
        [1.021668, 0.2468, 0.4258, 0.3490],
        [1.659637, 0.4305, 0.7112, 0.5179],
        [2.999587, 0.8440, 1.3418, 0.8238],
        [5.49475, 1.7234, 2.4657, 1.3057],
        [7.88386, 2.704, 3.535, 1.646],
        [12.5039, 4.560, 5.697, 2.247],
        [23.65275, 9.228, 11.059, 3.366]],

        [[0.6932, 0.031, 0.260, 0.401],
        [3.5700, 0.3494, 1.2805, 1.9401],
        [7.6203, 0.9519, 2.82, 3.84],
        [11.8074, 1.7018, 4.513, 5.5927],
        [20.1832, 3.428, 8.068, 8.687],
        [35.0914, 7.701, 14.092, 13.299],
        [48.891, 11.860, 20.08, 16.947],
        [74.9545, 20.402, 31.744, 22.809],
        [136.1738, 42.66, 59.71, 33.799]],

        [[2.5019, 0.0699, 0.893, 1.539],
        [12.361, 0.797, 4.394, 7.169],
        [25.7461, 2.415, 9.050, 14.281],
        [39.2661, 4.262, 14.277, 20.728],
        [65.7911, 8.537, 25.197, 32.067],
        [111.9426, 17.817, 46.532, 47.593],
        [154.206, 29.701, 60.74, 63.763],
        [233.633, 58.33, 84.76, 90.537],
        [415.943, 124.13, 157.92, 133.89]],

        [[6.210, 0.1208, 2.189, 3.900],
        [30.156, 1.574, 10.473, 18.109],
        [62.210, 4.657, 21.227, 36.106],
        [94.127, 8.249, 33.543, 52.335],
        [156.099, 16.768, 58.513, 80.818],
        [262.598, 34.758, 108.546, 119.293],
        [359.072, 60.75, 140.51, 157.82],
        [539.13, 120.09, 188.45, 230.58],
        [947.33, 257.67, 348.35, 341.31]]]

    
    plot_ratio(eval(system), w, [0,1,2,3], labels)
    
    tikzplotlib.save("/home/evenmn/Master-thesis/doc/text/pgf/" + system + ".tex")
